### **8086 Microprocessor Interrupts**

Interrupts are a mechanism that allows the 8086 microprocessor to respond to external events or requests asynchronously, by temporarily halting its current execution and jumping to a special routine called an **Interrupt Service Routine (ISR)**. The interrupt mechanism is essential for handling real-time events, such as hardware requests, system errors, or user interactions.

The **8086 microprocessor** supports both **hardware interrupts** (initiated by external devices) and **software interrupts** (initiated by the program itself).

---

### **Types of Interrupts in 8086**

1. **Hardware Interrupts**
2. **Software Interrupts**

---

### **1. Hardware Interrupts**

Hardware interrupts are triggered by external devices or hardware peripherals (such as keyboard, timer, etc.). The 8086 microprocessor supports **5 hardware interrupts** numbered from **INT 0** to **INT 5**.

- **INT 0 (Divide-by-zero Error)**: 
  - Triggered by the processor when a division by zero occurs.
  - Automatically invokes the interrupt handler to address this error.
  
- **INT 1 (Single Step Interrupt)**:
  - Used in debugging operations.
  - This interrupt occurs after each instruction to allow the debugger to take control of the CPU.

- **INT 2 (Non-maskable Interrupt, NMI)**:
  - This interrupt is non-maskable and is used for high-priority, system-level events (such as power failures).
  - This is a hardware-driven interrupt, which cannot be disabled.
  
- **INT 3 (Breakpoint Interrupt)**:
  - Generated by the **debugger** during debugging.
  - The interrupt can be triggered using the `INT 3` instruction and causes the microprocessor to stop execution for inspection.
  
- **INT 4 to INT 5 (Reserved for Future Use)**:
  - These interrupts are reserved for future hardware expansion.

---

### **2. Software Interrupts**

Software interrupts are initiated by the program itself through the **INT** instruction. These interrupts allow a program to invoke system-level functions, such as system calls or other predefined routines.

- **INT (Interrupt)**: 
  - The `INT` instruction is used to invoke software interrupts by specifying an interrupt number (e.g., `INT 21h` for MS-DOS system calls).
  
- **INTR (Interrupt Request)**: 
  - This pin allows external devices to interrupt the processor asynchronously. The processor checks this line to determine if an interrupt request is pending.
  
- **INTR Maskable Interrupts**: 
  - Can be enabled or disabled through the **Interrupt Flag (IF)**.

---

### **Interrupt Vector Table (IVT)**

The 8086 uses an **Interrupt Vector Table (IVT)**, which is a table of pointers (memory addresses) that contain the addresses of the Interrupt Service Routines (ISRs). The IVT starts at memory location **0000h** and occupies the first **1024 bytes** of memory. Each interrupt type is assigned a specific entry in the table:

- **Each entry in the IVT** is 4 bytes long and corresponds to one interrupt vector.
- **Interrupt Vector Address**: The interrupt vector address is the address of the ISR. For example, when an interrupt occurs, the 8086 microprocessor looks up the interrupt vector in the IVT to jump to the correct ISR.

### **Interrupt Vector Table Layout (First 1024 Bytes)**

| **Interrupt Number** | **Vector Address**  | **Interrupt Service Routine (ISR)**            |
|----------------------|---------------------|-----------------------------------------------|
| INT 0                | 0000h to 0003h       | Divide-by-zero Error ISR                     |
| INT 1                | 0004h to 0007h       | Single Step Interrupt ISR                    |
| INT 2                | 0008h to 000Bh       | Non-maskable Interrupt (NMI) ISR             |
| INT 3                | 000Ch to 000Fh       | Breakpoint Interrupt ISR                     |
| INT 4 to INT 5       | Reserved             | Reserved for future hardware or system use   |
| INT 6 to INT 31      | User-defined        | Custom interrupts or system-level interrupts |
| INT 32 to INT 255    | Operating System-specific | OS-specific interrupt handling (e.g., I/O, system calls) |

---

### **Interrupt Flags**

The 8086 microprocessor uses several control flags that influence the behavior of interrupts. These flags are stored in the **FLAGS register**, which is a 16-bit register containing various status and control bits.

- **Interrupt Flag (IF)**:
  - The **Interrupt Flag (IF)** controls the **masking of interrupts**. 
  - When **IF = 1**, interrupts are enabled, and the 8086 can process interrupt requests (INTR).
  - When **IF = 0**, interrupts are disabled, and the processor ignores interrupt requests.

- **Trap Flag (TF)**:
  - The **Trap Flag (TF)** is used for single-step debugging. It allows the program to stop after executing each instruction, making it useful for debugging.

---

### **Maskable vs Non-maskable Interrupts**

- **Maskable Interrupts (INTR)**:
  - These interrupts can be disabled by clearing the **Interrupt Flag (IF)** in the FLAGS register.
  - Example: The 8086 can disable maskable interrupts temporarily, allowing the CPU to complete a critical section of code before processing interrupts.

- **Non-maskable Interrupts (NMI)**:
  - These interrupts cannot be masked or disabled by software.
  - Typically used for high-priority system errors like power failure or hardware malfunctions.
  
---

### **Interrupt Handling Process in 8086**

1. **Interrupt Request (INTR)**:
   - When an external device sends an interrupt request signal (INTR), the 8086 checks the **Interrupt Flag (IF)** to see if interrupts are enabled.
   - If **IF** is set, the microprocessor responds to the interrupt.

2. **Interrupt Vector Lookup**:
   - The 8086 looks up the **Interrupt Vector Table (IVT)** for the corresponding interrupt number.
   - The processor fetches the address of the **Interrupt Service Routine (ISR)** from the table.

3. **Saving the State**:
   - The processor saves the current **program counter (PC)** and **flags** (using the **PUSH** operation) before jumping to the ISR to ensure that the processor can return to its previous state after interrupt processing is complete.

4. **Interrupt Service Routine (ISR)**:
   - The processor jumps to the address of the ISR and executes the interrupt handling routine.
   - After the ISR completes its execution, the processor uses the **IRET (Interrupt Return)** instruction to return control to the interrupted program.

5. **Restoration**:
   - The **IRET** instruction restores the **program counter (PC)** and **flags** from the stack, resuming execution from where it was interrupted.

---

### **Important Interrupt Instructions in 8086**

- **INTR (Interrupt Request)**:
  - A pin on the processor that allows external devices to request an interrupt.
  
- **INT**:
  - A software instruction used to trigger an interrupt by specifying an interrupt number.
  - Example: `INT 21h` (Executes a software interrupt with interrupt vector 21h, often used for system calls in MS-DOS).

- **IRET (Interrupt Return)**:
  - The **IRET** instruction is used to return from an interrupt service routine and restore the previous state of the processor.
  
---

### **Conclusion**

The 8086 microprocessor supports a rich interrupt system that handles both hardware and software interrupts. It allows for asynchronous processing of external events while running programs, which is crucial for real-time applications and efficient multitasking. The use of an **Interrupt Vector Table (IVT)** allows the processor to quickly find and jump to the appropriate **Interrupt Service Routine (ISR)** to handle specific types of interrupts. Additionally, the control flags and interrupt instructions provide flexibility in managing interrupt requests and ensuring that the processor operates efficiently.
